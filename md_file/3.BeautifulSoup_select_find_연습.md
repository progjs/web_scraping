
#### select함수를 사용해서 데이터를 scraping하면서 CSS Selector 익숙해지기


```python
book_html="""
<ul id="bible">
<li id="ge" class="first">
<ul class="second">
<div>
<li><span>aa<span></li>
<li>bb</li>
<div>
</ul>
</li>
<li id="ex" class="first">나의첫사회생활</li>
<li id="le" class="second">Still Me</li>
<li id="nu" class="second">화염과 분노 : 도널드 트럼프의 백악관 뒷이야기</li>
<li id="de">매일 좋을 수만은 없는 여행을 한다</li>
</ul>
"""

from bs4 import BeautifulSoup

soup = BeautifulSoup(book_html, 'html.parser')
# print(soup.select('ul li'))
```


```python
for li_tag in soup.select('ul li'):
    print(li_tag)
```

    <li class="first" id="ge">
    <ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>
    </li>
    <li>aa</li>
    <li>bb</li>
    <li class="first" id="ex">나의첫사회생활</li>
    <li class="second" id="le">Still Me</li>
    <li class="second" id="nu">화염과 분노 : 도널드 트럼프의 백악관 뒷이야기</li>
    <li id="de">매일 좋을 수만은 없는 여행을 한다</li>
    


```python
# id가 ge인 tag 가져오기
# select, select_one
print(type(soup.select('#ge')), soup.select('#ge')) #<class 'list'>
print()
print(type(soup.select_one('#ge')), soup.select_one('#ge')) #<class 'bs4.element.Tag'>
print()

# print(soup.select('#ge').text) # list라서 안된다
print(soup.select('#ge')[0].text.strip()) 
print(soup.select_one('#ge').text.strip()) # type=tag라서 가능
```

    <class 'list'> [<li class="first" id="ge">
    <ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>
    </li>]
    
    <class 'bs4.element.Tag'> <li class="first" id="ge">
    <ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>
    </li>
    
    aa
    bb
    aa
    bb
    


```python
# class명이 second
print(soup.select('.second'))
print()
print(soup.select('li .second')) # 결과가 list
print()
print(soup.select_one('li .second'))
```

    [<ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>, <li class="second" id="le">Still Me</li>, <li class="second" id="nu">화염과 분노 : 도널드 트럼프의 백악관 뒷이야기</li>]
    
    [<ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>]
    
    <ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>
    


```python
# find()와 find_all()
# find() == select_one()    find_all() == select()
print(type(soup.find_all('li')), soup.find_all('li')) #<class 'bs4.element.ResultSet'>
print()
print(type(soup.find('li')), soup.find('li')) #<class 'bs4.element.Tag'>
```

    <class 'bs4.element.ResultSet'> [<li class="first" id="ge">
    <ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>
    </li>, <li>aa</li>, <li>bb</li>, <li class="first" id="ex">나의첫사회생활</li>, <li class="second" id="le">Still Me</li>, <li class="second" id="nu">화염과 분노 : 도널드 트럼프의 백악관 뒷이야기</li>, <li id="de">매일 좋을 수만은 없는 여행을 한다</li>]
    
    <class 'bs4.element.Tag'> <li class="first" id="ge">
    <ul class="second">
    <li>aa</li>
    <li>bb</li>
    </ul>
    </li>
    


```python
# li .second
print(type(soup.find_all('li',attrs={'class':'second'})), soup.find_all('li',attrs={'class':'second'})) 
print()
print(type(soup.find('li',attrs={'class':'second'})), soup.find('li',attrs={'class':'second'}))

print(soup.find('li',attrs={'class':'second'}).text)
print(soup.find('li',attrs={'class':'second'}).string)

print(soup.select_one('li.second').text)
print(soup.select_one('li.second').string)
```

    <class 'bs4.element.ResultSet'> [<li class="second" id="le">Still Me</li>, <li class="second" id="nu">화염과 분노 : 도널드 트럼프의 백악관 뒷이야기</li>]
    
    <class 'bs4.element.Tag'> <li class="second" id="le">Still Me</li>
    Still Me
    Still Me
    Still Me
    Still Me
    


```python
# css selector를 입력받아서 결과를 반환하는 lambda 함수 정의
sel = lambda ex: print(soup.select_one(ex).string)
```


```python
sel('li.second')
sel('li#ex')
sel('ul #ex')
sel('ul li#le')
sel('ul > li#le') # >는 바로 아래 child tag값만 추출
sel('.second li') # >없으면 select나 find_all일때 모든 child 추출
sel("li[id='ex']")
sel('li:nth-of-type(5)')
```

    Still Me
    나의첫사회생활
    나의첫사회생활
    Still Me
    Still Me
    None
    나의첫사회생활
    Still Me
    


```python
print(soup.select('ul.second li')) # >없으면 select나 find_all일때 모든 child 추출
print()
print(soup.select('ul.second > li')) # >는 바로 아래 child tag값만 추출
```

    [<li><span>aa<span></span></span></li>, <li>bb</li>]
    
    []
    


```python
print(len(soup.select('li')), soup.select('li'))
sel('li:nth-of-type(5)')
```

    7 [<li class="first" id="ge">
    <ul class="second">
    <div>
    <li><span>aa<span></span></span></li>
    <li>bb</li>
    <div>
    </div></div></ul>
    </li>, <li><span>aa<span></span></span></li>, <li>bb</li>, <li class="first" id="ex">나의첫사회생활</li>, <li class="second" id="le">Still Me</li>, <li class="second" id="nu">화염과 분노 : 도널드 트럼프의 백악관 뒷이야기</li>, <li id="de">매일 좋을 수만은 없는 여행을 한다</li>]
    Still Me
    

### css selector 연습


```python
html="""
<html>
<body>
<div id="main-goods" role="page">
<h1>과일과 채소</h1>
<ul id="fr-list">
<li class="red green" data-lo="ko">사과</li>
<li class="purple" data-lo="us">포도</li>
<li class="yellow" data-lo="us">레몬</li>
<li class="yellow" data-lo="ko">오렌지</li>
</ul>
<ul id="ve-list">
<li class="white green" data-lo="ko">무</li>
<li class="red green" data-lo="us">파프리카</li>
<li class="black" data-lo="ko">가지</li>
<li class="black" data-lo="us">아보카도</li>
<li class="white" data-lo="cn">연근</li>
</ul>
</div>
<body>
</html>
"""

from bs4 import BeautifulSoup

soup = BeautifulSoup(html, 'html.parser')
soup
```




    
    <html>
    <body>
    <div id="main-goods" role="page">
    <h1>과일과 채소</h1>
    <ul id="fr-list">
    <li class="red green" data-lo="ko">사과</li>
    <li class="purple" data-lo="us">포도</li>
    <li class="yellow" data-lo="us">레몬</li>
    <li class="yellow" data-lo="ko">오렌지</li>
    </ul>
    <ul id="ve-list">
    <li class="white green" data-lo="ko">무</li>
    <li class="red green" data-lo="us">파프리카</li>
    <li class="black" data-lo="ko">가지</li>
    <li class="black" data-lo="us">아보카도</li>
    <li class="white" data-lo="cn">연근</li>
    </ul>
    </div>
    <body>
    </body></body></html>




```python
# 채소 이름 가져오기
print('채소: ', end = '')
veg_tags = soup.select('#ve-list li')

veg_name = []
for veg_tag in veg_tags:
    veg_name.append(veg_tag.text)
print(veg_name)

# 과일 이름 가져오기
print('과일: ', end = '')
fr_tags = soup.select('#fr-list li')

fr_name = []
for fr_tag in fr_tags:
    fr_name.append(fr_tag.text)
print(fr_name)

# 채소 중에서 'ko' 국산채소만 가져오기
print('국산 채소: ', end = '')
korean_veg_tag = soup.select('#ve-list li[data-lo="ko"]')

korean_veg = []
for lo_tag in korean_veg_tag:
    korean_veg.append(lo_tag.text)
print(korean_veg)

# 과일 중에서 'us' 미국과일만 가져오기
print('미국산 과일: ', end = '')
us_fr_tag = soup.select('#fr-list li[data-lo="us"]')

us_fruit = []
for lo_tag in us_fr_tag:
    us_fruit.append(lo_tag.text)
print(us_fruit)

# 과일 중에서 노랑만 가져오기
print('노란 과일: ', end = '')
li_tag_list = soup.select('#fr-list li.yellow')

yellow_fr = []
for li_tag in li_tag_list:
    yellow_fr.append(li_tag.string)
print(yellow_fr)

# 채소 중에서 black만 가져오기
print('까만 채소: ', end = '')
li_tag_list = soup.select('li.black')

black_veg = []
for li_tag in li_tag_list:
    black_veg.append(li_tag.string)
print(black_veg)

# 과일과 채소중에서 red green만 가져오기
print('red green 식재료: ', end = '')
li_tag_list = soup.select('li[class="red green"]')

red_green = []
for li_tag in li_tag_list:
    red_green.append(li_tag.string)
print(red_green)

# 8번째 li 가져오기
print('8번째 식재료: ', end = '')
li_tag8 = soup.select_one('li:nth-of-type(8)').text
print(li_tag8)

# 전체에서 us 가져오기
print('미국산: ', end = '')
li_tag_list = soup.select('li[data-lo="us"]')

us_list = []
for li_tag in li_tag_list:
    us_list.append(li_tag.text)
print(us_list)
```

    채소: ['무', '파프리카', '가지', '아보카도', '연근']
    과일: ['사과', '포도', '레몬', '오렌지']
    국산 채소: ['무', '가지']
    미국산 과일: ['포도', '레몬']
    노란 과일: ['레몬', '오렌지']
    까만 채소: ['가지', '아보카도']
    red green 식재료: ['사과', '파프리카']
    8번째 식재료: 아보카도
    미국산: ['포도', '레몬', '파프리카', '아보카도']
    
